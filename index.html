<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Memories | AR Experience</title>

    <!-- A-Frame and AR.js Libraries -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <style>
        /* --- CSS Styles --- */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');

        :root {
            --primary-bg: #0a192f;
            --text-light: #ccd6f6;
            --accent: #64ffda;
            --accent-dark: rgba(100, 255, 218, 0.1);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--primary-bg);
            color: var(--text-light);
            margin: 0; 
            overflow: hidden;
        }

        /* The overlays are now used to show/hide content */
        .overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column; text-align: center;
            background-color: var(--primary-bg);
            z-index: 10;
            transition: opacity 0.5s, visibility 0.5s;
        }
        
        .overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        h1 { font-size: 2.8rem; color: white; margin-bottom: 1rem; }
        p { font-size: 1.2rem; margin-bottom: 2.5rem; max-width: 500px; }
        .button-container { display: flex; gap: 20px; }
        .action-button {
            background: transparent; color: var(--accent); padding: 18px 30px;
            font-size: 1rem; font-weight: bold; cursor: pointer;
            border: 2px solid var(--accent); border-radius: 8px;
            transition: background-color 0.3s;
        }
        #video-overlay { z-index: 1001; }
        #anniversary-video { width: 95%; max-width: 900px; border-radius: 12px; }
        .close-btn { position: absolute; top: 20px; right: 25px; font-size: 45px; font-weight: bold; color: white; cursor: pointer; }
    </style>
</head>

<body>
    <!-- Start Page and Video player are overlays -->
    <div id="start-container" class="overlay">
        <h1>Happy Anniversary</h1>
        <p>Choose an experience</p>
        <div class="button-container">
            <button id="watch-video-btn" class="action-button">🎬 Watch Video</button>
            <button id="start-ar-btn" class="action-button">✨ Start AR Gallery</button>
        </div>
    </div>

    <div id="video-overlay" class="overlay hidden">
        <span id="close-video-btn" class="close-btn">&times;</span>
        <video id="anniversary-video" controls>
             <!-- ❗️❗️ PASTE YOUR VIDEO LINK HERE ❗️❗️ -->
            <source src="YOUR_VIDEO_LINK.mp4" type="video/mp4">
        </video>
    </div>

    <!-- THIS IS YOUR ORIGINAL, WORKING AR SCENE STRUCTURE -->
    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>
        
        <a-assets timeout="30000">
            <img id="empty-frame" src="https://i.imgur.com/aC3z2G5.png" crossorigin="anonymous">
            <!-- ❗️❗️ PASTE YOUR REAL PHOTO LINKS HERE ❗️❗️ -->
            <img id="real-photo-1" src="YOUR_PHOTO_1_LINK.jpg" crossorigin="anonymous">
            <img id="real-photo-2" src="YOUR_PHOTO_2_LINK.jpg" crossorigin="anonymous">
            <img id="real-photo-3" src="YOUR_PHOTO_3_LINK.jpg" crossorigin="anonymous">
            <img id="real-photo-4" src="YOUR_PHOTO_4_LINK.jpg" crossorigin="anonymous">
            <img id="real-photo-5" src="YOUR_PHOTO_5_LINK.jpg" crossorigin="anonymous">
        </a-assets>

        <!-- Using your marker settings -->
        <a-marker id="main-marker" type='pattern' url='./marker/pattern-marker.patt' smooth="true" smoothCount="5" smoothTolerance="0.01" smoothThreshold="2">
            
            <a-entity 
                id="gallery-container"
                position="0 0.6 0" 
                scale="1 1 1"
                visible="false">

                <!-- Frame 1 (Top Left) -->
                <a-entity position="-1.0 0.6 0" rotation="-90 0 10">
                    <a-plane class="photo-plane" material="src: #real-photo-1; transparent: true; opacity: 1;" width="0.72" height="0.9" position="0 0 0.01"></a-plane>
                    <a-plane material="src: #empty-frame; transparent: true;" width="0.8" height="1.0"></a-plane>
                </a-entity>
                
                <!-- Frame 2 (Top Middle) -->
                <a-entity position="0 0.8 0" rotation="-90 0 0">
                    <a-plane class="photo-plane" material="src: #real-photo-2; transparent: true; opacity: 1;" width="0.81" height="0.54" position="0 0 0.01"></a-plane>
                    <a-plane material="src: #empty-frame; transparent: true;" width="0.9" height="0.6"></a-plane>
                </a-entity>
                
                <!-- Frame 3 (Top Right) -->
                <a-entity position="1.0 0.7 0" rotation="-90 0 0">
                    <a-plane class="photo-plane" material="src: #real-photo-3; transparent: true; opacity: 1;" width="0.72" height="0.48" position="0 0 0.01"></a-plane>
                    <a-plane material="src: #empty-frame; transparent: true;" width="0.8" height="0.53"></a-plane>
                </a-entity>
                
                <!-- Frame 4 (Bottom Left) -->
                <a-entity position="-1.0 -0.4 0" rotation="-90 0 0">
                    <a-plane class="photo-plane" material="src: #real-photo-4; transparent: true; opacity: 1;" width="0.81" height="0.54" position="0 0 0.01"></a-plane>
                    <a-plane material="src: #empty-frame; transparent: true;" width="0.9" height="0.6"></a-plane>
                </a-entity>
                
                <!-- Frame 5 (Middle Right) -->
                <a-entity position="1.0 -0.2 0" rotation="-90 0 -5">
                    <a-plane class="photo-plane" material="src: #real-photo-5; transparent: true; opacity: 1;" width="0.72" height="0.9" position="0 0 0.01"></a-plane>
                    <a-plane material="src: #empty-frame; transparent: true;" width="0.8" height="1.0"></a-plane>
                </a-entity>

            </a-entity>
        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startContainer = document.getElementById('start-container');
            const videoOverlay = document.getElementById('video-overlay');
            const videoPlayer = document.getElementById('anniversary-video');
            const startArBtn = document.getElementById('start-ar-btn');
            const watchVideoBtn = document.getElementById('watch-video-btn');
            const closeVideoBtn = document.getElementById('close-video-btn');
            
            const marker = document.getElementById('main-marker');
            const gallery = document.getElementById('gallery-container');

            // Hide the gallery initially
            gallery.setAttribute('visible', 'false');

            // When marker is found, show the gallery
            marker.addEventListener('markerFound', () => {
                gallery.setAttribute('visible', 'true');
            });

            // When marker is lost, hide the gallery
            marker.addEventListener('markerLost', () => {
                gallery.setAttribute('visible', 'false');
            });

            // Button to start AR: just hides the start screen
            startArBtn.addEventListener('click', () => {
                startContainer.classList.add('hidden');
            });

            // Button to watch video
            watchVideoBtn.addEventListener('click', () => {
                videoOverlay.classList.remove('hidden');
                videoPlayer.play();
            });

            // Button to close video
            closeVideoBtn.addEventListener('click', () => {
                videoOverlay.classList.add('hidden');
                videoPlayer.pause();
            });
        });
    </script>
</body>
</html>
